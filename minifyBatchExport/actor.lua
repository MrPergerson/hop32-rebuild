n={}e={}l=1o=0c=0local l,o=20,0function r(n,e,l)for n=1,n,1do e[n]=d(l,n)end end function d(n,e)local n={id=e,type=n.type,enabled=false,inputDisabled=false,xpos=0,ypos=0,startPosition=0,boundsOffsetX=0,boundsOffsetY=0,vx=0,vy=0,move_dir=-1,width=n.width,height=n.height,boundsOffsetX=0,boundsOffsetY=0,onGround=false,bounce_charge=0,jump_height=1.5,jump_distance=1.5,jump_gravity=0,fall_gravity=50,sprite=n.sprite,sprite2=n.sprite2,disabledCount=0,ai_enabled=false,state=1,totalTimeEnabled=0,won=false,timer_1=0,capture_tracker={},tracker_beam={xpos=0,ypos=0,width=16,height=32,boundsOffsetX=4,boundsOffsetY=28}}return n end function i(l,e,o,a)local n=nil if e==-1do for l,e in pairs(l)do if(e.enabled==false)n=e break
end if(n==nil)printh"no more actors available"return
else n=l[e]if(n==nil)printh("can't find actor with id "..e)return
end n.enabled=true n.ai_enabled=true n.inputDisabled=false n.state=1n.search_timer=5+flr(rnd(5))n.ypos=a n.xpos=o n.bounce_charge=0return n end function u(n)n.enabled=false n.ai_enabled=false n.disabledCount=n.disabledCount+1n.totalTimeEnabled=n.totalTimeEnabled+(time()-n.totalTimeEnabled)n.vx=0n.vy=0end function s(n,e)if(n.vy>=0)l=n.fall_gravity*8else l=n.jump_gravity*8
local o,a=n.xpos+n.vx*e+5*e*e,n.ypos+n.vy*e+.5*l*e*e n.vx+=10*e n.vy+=l*e n.vy=min(n.vy,200)return{xpos=o,ypos=a}end function h(n)if(n.onGround and not n.won)local e,l=n.jump_distance*.6,n.jump_distance*.4local a=-2*n.jump_height*4/e n.jump_gravity=2*n.jump_height*4*4/(e*e)n.fall_gravity=2*n.jump_height*4*4/(l*l)n.vx=32n.vy=a*8n.bounce_charge=0sfx(0)o=time()
end function b(n,e)n.vx=n.move_dir*e if n.xpos<a+8do n.move_dir=abs(n.move_dir)n.xpos=a+8elseif n.xpos>a+110do n.move_dir=-abs(n.move_dir)n.xpos=a+110end end function k(n)if(n.xpos+8<a-16or n.ypos>m+200)return true
return false end function v(n)for e,n in pairs(n)do spr(n.sprite,n.xpos,n.ypos)end end function w(n,e)local n,e=f(n),f(e)return n.left<e.right and n.right>e.left and n.top<e.bottom and n.bottom>e.top end function g(n,e)local l,o=f(n),f(e)return l.bottom>o.top and n.ypos<e.ypos and n.vy>0end function f(n)local e,l,o,n=n.xpos+n.boundsOffsetX,n.ypos+n.boundsOffsetY,n.width/2,n.height/2return{left=e-o,right=e+o,top=l-n,bottom=l+n}end